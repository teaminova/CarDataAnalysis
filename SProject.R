
#–ü–†–û–ï–ö–¢ –ü–û –ü–†–ï–î–ú–ï–¢–û–¢ –ë–ò–ó–ù–ò–° –°–¢–ê–¢–ò–°–¢–ò–ö–ê
#–¢–ï–ê –ú–ò–ù–û–í–ê
#–ò–ù–î–ï–ö–° –ë–†. 213004


#–ò–ù–°–¢–ê–õ–ê–¶–ò–à–ê –ù–ê –ü–ê–ö–ï–¢–ò
#–õ–∏—Å—Ç–∞ –Ω–∞ –Ω–µ–æ–ø—Ö–æ–¥–Ω–∏ –ø–∞–∫–µ—Ç–∏
my_packages <- c("data.table", 
                 "ggplot2", 
                 "distributions3", 
                 "BSDA", 
                 "pivottabler"
                )
#–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –∞–≤—Ç–æ–º–∞—Ç—Å–∫–∞ –∏–Ω—Å—Ç–∞–ª–∞—Ü–∏—ò–∞ –Ω–∞ –ø–∞–∫–µ—Ç–∏—Ç–µ –∫–æ–∏ –Ω–µ–¥–æ—Å—Ç–∞—Å—É–≤–∞–∞—Ç
not_installed <- my_packages[!(my_packages %in% installed.packages()[ , "Package"])]
if(length(not_installed)) install.packages(not_installed)

#–ò–º–ø–æ—Ä—Ç–∏—Ä–∞—ö–µ –Ω–∞ –±–∞–∑–∞—Ç–∞ –Ω–∞ –ø–æ–¥–∞—Ç–æ—Ü–∏
RAW_DF = read.csv('C:/Users/Tea/Desktop/Statistika/car_data.csv')

#–ü—Ä–µ–∏–º–µ–Ω—É–≤–∞—ö–µ –Ω–∞ –¥–æ–ª–≥–∏—Ç–µ –∏–º–∏—ö–∞ –Ω–∞ –Ω–µ–∫–æ–∏ –∫–æ–ª–æ–Ω–∏
names(RAW_DF)[names(RAW_DF) == "Kilometers.Driven"] <- "Kilometers"
names(RAW_DF)[names(RAW_DF) == "Selling.Price"] <- "Price"


# –ò–ù–ò–¶–ò–à–ê–õ–ù–ê –û–ë–†–ê–ë–û–¢–ö–ê: –û–¢–°–¢–†–ê–ù–£–í–ê–ä–ï –ù–ê –ï–ö–°–¢–†–ï–ú–ù–ò –í–†–ï–î–ù–û–°–¢–ò
#–ü—Ä–µ—Å–º–µ—Ç–∫–∞ –Ω–∞ –ø—Ä–≤–∏–æ—Ç –∏ —Ç—Ä–µ—Ç–∏–æ—Ç –∫–≤–∞—Ä—Ç–∞–ª, –∫–∞–∫–æ –∏ –∏–Ω—Ç–µ—Ä–∫–≤–∞—Ä—Ç–∞–ª–Ω–∏–æ—Ç —Ä–∞—Å–ø–æ–Ω –∑–∞
#–≤—Ä–µ–¥–Ω–æ—Å—Ç–∏—Ç–µ –≤–æ –∫–æ–ª–æ–Ω–∏—Ç–µ 'Kilometers' –∏ 'Price'
init_Q1_k <- quantile(RAW_DF$Kilometers, .25)
init_Q3_k <- quantile(RAW_DF$Kilometers, .75)
init_IQR_k <- IQR(RAW_DF$Kilometers)

init_Q1_p <- quantile(RAW_DF$Price, .25)
init_Q3_p <- quantile(RAW_DF$Price, .75)
init_IQR_p <- IQR(RAW_DF$Price)

#–ì—Ä–∞–Ω–∏—Ü–∏ –∑–∞ –æ–¥—Ä–µ–¥—É–≤–∞—ö–µ –Ω–∞ –µ–∫—Å—Ç—Ä–µ–º–∏
init_Q1_k - 1.5*init_IQR_k
init_Q3_k + 1.5*init_IQR_k

init_Q1_p - 1.5*init_IQR_p
init_Q3_p + 1.5*init_IQR_p

#–°–µ –∑–∞–¥—Ä–∂—É–≤–∞–∞—Ç —Å–∞–º–æ –µ–¥–∏–Ω–∫–∏—Ç–µ –∫–æ–∏ –∏–º–∞–∞—Ç –≤—Ä–µ–¥–Ω–æ—Å—Ç –≤–æ –æ–ø—Å–µ–≥–æ—Ç
# (Q1 ‚àí 1.5*IQR, Q3 + 1.5*IQR) —Å–ø–æ—Ä–µ–¥ –¥–≤–µ—Ç–µ –æ–±–µ–ª–µ–∂—ò–∞
CARS <- subset(RAW_DF,
               RAW_DF$Kilometers > (init_Q1_k - 1.5*init_IQR_k)
               & RAW_DF$Kilometers < (init_Q3_k + 1.5*init_IQR_k)
               & RAW_DF$Price > (init_Q1_p - 1.5*init_IQR_p)
               & RAW_DF$Price < (init_Q3_p + 1.5*init_IQR_p)
              )

#–î–∏–º–µ–Ω–∑–∏—ò–∞ (–±—Ä–æ—ò –Ω–∞ —Ä–µ–¥–æ–≤–∏, –±—Ä–æ—ò –Ω–∞ –∫–æ–ª–æ–Ω–∏) –Ω–∞ –∏–Ω–∏—Ü–∏—ò–∞–ª–Ω–æ—Ç–æ –ø–æ–¥–∞—Ç–æ—á–Ω–æ –º–Ω–æ–∂–µ—Å—Ç–≤–æ
dim(RAW_DF)

#–î–∏–º–µ–Ω–∑–∏—ò–∞ (–±—Ä–æ—ò –Ω–∞ —Ä–µ–¥–æ–≤–∏, –±—Ä–æ—ò –Ω–∞ –∫–æ–ª–æ–Ω–∏) –Ω–∞ —Ñ–∏–ª—Ç—Ä–∏—Ä–∞–Ω–æ—Ç–æ –ø–æ–¥–∞—Ç–æ—á–Ω–æ –º–Ω–æ–∂–µ—Å—Ç–≤–æ
dim(CARS)


# A. –ü–†–í –î–ï–õ
# –ó–ê–î–ê–ß–ê –ë–†. 1
#–ò–∑—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ —Ç–∞–±–µ–ª–∞ –∑–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–±–∞ –Ω–∞ —á–µ—Å—Ç–æ—Ç–∏ 

#–°—Ä–µ–¥—É–≤–∞—ö–µ –Ω–∞ –∫–æ–ª–æ–Ω–∏—Ç–µ (–ø–æ–¥–µ–ª–µ–Ω–∏ —Å–æ 1000 –∑–∞ –ø–æ–¥–æ–±—Ä–∞ –≤–∏–∑—É–µ–ª–∏–∑–∞—Ü–∏—ò–∞)
CARS$Kilometers1 = round(CARS$Kilometers/1000,0)
CARS$Price1 = round(CARS$Price/1000,0)

#–°–æ—Ä—Ç–∏—Ä–∞–Ω–∏ –∫–æ–ª–æ–Ω–∏ –∑–∞ –ø–æ–¥–æ—Ü–Ω–µ–∂–Ω–∞ —É–ø–æ—Ç—Ä–µ–±–∞
sorted_Kilometers1 = sort(CARS$Kilometers1)
sorted_Price1 = sort(CARS$Price1)

#–ü—Ä–µ—Å–º–µ—Ç–∫–∞ –Ω–∞ –±—Ä–æ—ò –Ω–∞ –ø–æ–¥–∞—Ç–æ—Ü–∏ –≤–æ –∫–æ–ª–æ–Ω–∞ Kilometers1
n = length(CARS[,'Kilometers1'])

#–ü—Ä–µ—Å–º–µ—Ç–∫–∞ –Ω–∞ –æ–ø—Å–µ–≥
R1 = range(CARS$Kilometers1)
R2 = range(CARS$Price1)

#–ü—Ä–µ—Å–º–µ—Ç–∫–∞ –Ω–∞ –±—Ä–æ—ò –Ω–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∏
k = round(1+3.322*(log10(n)),0)

#–û–ø—Ä–µ–¥–µ–ª—É–≤–∞—ö–µ –Ω–∞ —à–∏—Ä–∏–Ω–∞ –Ω–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª
w1 = ceiling(((R1[2]-R1[1])/k))
w2 = ceiling(((R2[2]-R2[1])/k))

#–ö—Ä–µ–∏—Ä–∞—ö–µ –Ω–∞ –∏–Ω–µ—Ä–≤–∞–ª–∏
breaks1 = seq(R1[1], R1[1]+k*w1, by = w1)
i1 = cut(CARS$Kilometers1, breaks1, right = FALSE)
–ß–µ—Å—Ç–æ—Ç–∏1 = table(i1)

breaks2 = seq(R2[1], R2[1]+k*w2, by = w2)
i2 = cut(CARS$Price1, breaks2, right = FALSE)
–ß–µ—Å—Ç–æ—Ç–∏2 = table(i2)

#–ö—Ä–µ–∏—Ä–∞—ö–µ –Ω–∞ –≤–µ–∫—Ç–æ—Ä –∑–∞ —Å—Ä–µ–¥–Ω–∏ —Ç–æ—á–∫–∏
–°—Ä–µ–¥–Ω–∏_—Ç–æ—á–∫–∏1 = c()
for (i in 1:k){
  new_elements1 = R1[1] + i*w1 - w1/2
  –°—Ä–µ–¥–Ω–∏_—Ç–æ—á–∫–∏1 = c(–°—Ä–µ–¥–Ω–∏_—Ç–æ—á–∫–∏1, new_elements1)
}

–°—Ä–µ–¥–Ω–∏_—Ç–æ—á–∫–∏2 = c()
for (i in 1:k){
  new_elements2 = R2[1] + i*w2 - w2/2
  –°—Ä–µ–¥–Ω–∏_—Ç–æ—á–∫–∏2 = c(–°—Ä–µ–¥–Ω–∏_—Ç–æ—á–∫–∏2, new_elements2)
}

#–ö—Ä–µ–∏—Ä–∞—ö–µ –Ω–∞ —Ç–∞–±–µ–ª–∞ –∑–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–±–∞ –Ω–∞ —á–µ—Å—Ç–æ—Ç–∏
–†–µ–ª–∞—Ç–∏–≤–Ω–∏_—á–µ—Å—Ç–æ—Ç–∏1 = round(–ß–µ—Å—Ç–æ—Ç–∏1/n, digits = 4)
–ö—É–º—É–ª–∞—Ç–∏–≤–Ω–∏_—á–µ—Å—Ç–æ—Ç–∏1 = cumsum(–ß–µ—Å—Ç–æ—Ç–∏1)
TABLE1 = as.data.frame(cbind(–°—Ä–µ–¥–Ω–∏_—Ç–æ—á–∫–∏1, –ß–µ—Å—Ç–æ—Ç–∏1, –†–µ–ª–∞—Ç–∏–≤–Ω–∏_—á–µ—Å—Ç–æ—Ç–∏1, –ö—É–º—É–ª–∞—Ç–∏–≤–Ω–∏_—á–µ—Å—Ç–æ—Ç–∏1))

–†–µ–ª–∞—Ç–∏–≤–Ω–∏_—á–µ—Å—Ç–æ—Ç–∏2 = round(–ß–µ—Å—Ç–æ—Ç–∏2/n, digits = 4)
–ö—É–º—É–ª–∞—Ç–∏–≤–Ω–∏_—á–µ—Å—Ç–æ—Ç–∏2 = cumsum(–ß–µ—Å—Ç–æ—Ç–∏2)
TABLE2 = as.data.frame(cbind(–°—Ä–µ–¥–Ω–∏_—Ç–æ—á–∫–∏2, –ß–µ—Å—Ç–æ—Ç–∏2, –†–µ–ª–∞—Ç–∏–≤–Ω–∏_—á–µ—Å—Ç–æ—Ç–∏2, –ö—É–º—É–ª–∞—Ç–∏–≤–Ω–∏_—á–µ—Å—Ç–æ—Ç–∏2))

#–ü—Ä–∏–∫–∞–∑ –Ω–∞ –ø–æ–¥–∞—Ç–æ—Ü–∏—Ç–µ –≤–æ —Ö–∏—Å—Ç–æ–≥—Ä–∞–º
hist(CARS$Kilometers1, 
     main = '–ß–µ—Å—Ç–æ—Ç–∞ –Ω–∞ –ø–æ–º–∏–Ω–∞—Ç–∏ –∫–∏–ª–æ–º–µ—Ç—Ä–∏',
     xlab = "–ü–æ–º–∏–Ω–∞—Ç–∏ –∫–∏–ª–æ–º–µ—Ç—Ä–∏ (–≤–æ –∏–ª—ò–∞–¥–∏)", 
     ylab = "–ß–µ—Å—Ç–æ—Ç–∞",
     border = "black", 
     col = "salmon", 
     xlim = c(0,R1[1]+k*w1),
     ylim = c(0,max(TABLE1$–ß–µ—Å—Ç–æ—Ç–∏1)),
     breaks = breaks1,
     right = FALSE,
     labels = TRUE
    )

hist(CARS$Price1,
     main = '–ß–µ—Å—Ç–æ—Ç–∞ –Ω–∞ —Ü–µ–Ω–∞',
     xlab = "–¶–µ–Ω–∞ (–≤–æ –∏–ª—ò–∞–¥–∏)",
     ylab = "–ß–µ—Å—Ç–æ—Ç–∞",
     border = "black",
     col = "skyblue",
     xlim = c(0,R2[1]+k*w2),
     ylim = c(0,max(TABLE2$–ß–µ—Å—Ç–æ—Ç–∏2)),
     breaks = breaks2,
     right = FALSE,
     labels = TRUE
    )

#–ü—Ä–∏–∫–∞–∑ –Ω–∞ –ø–æ–¥–∞—Ç–æ—Ü–∏—Ç–µ –≤–æ –ø–æ–ª–∏–≥–æ–Ω
plot(TABLE1$–ß–µ—Å—Ç–æ—Ç–∏1, 
     type = "b", 
     col = "salmon",
     xlab = "–ü–æ–º–∏–Ω–∞—Ç–∏ –∫–∏–ª–æ–º–µ—Ç—Ä–∏ (–≤–æ –∏–ª—ò–∞–¥–∏)", 
     ylab = "–ß–µ—Å—Ç–æ—Ç–∞", 
     main = "–ß–µ—Å—Ç–æ—Ç–∞ –Ω–∞ –ø–æ–º–∏–Ω–∞—Ç–∏ –∫–∏–ª–æ–º–µ—Ç—Ä–∏"
     )

plot(TABLE2$–ß–µ—Å—Ç–æ—Ç–∏2, 
     type = "b", 
     col = "blue",
     xlab = "–¶–µ–Ω–∞ (–≤–æ –∏–ª—ò–∞–¥–∏)", 
     ylab = "–ß–µ—Å—Ç–æ—Ç–∞", 
     main = "–ß–µ—Å—Ç–æ—Ç–∞ –Ω–∞ —Ü–µ–Ω–∞"
     )

plot(TABLE1$–ö—É–º—É–ª–∞—Ç–∏–≤–Ω–∏_—á–µ—Å—Ç–æ—Ç–∏1,
     type = "b", 
     col = "Salmon",
     xlab = "–ü–æ–º–∏–Ω–∞—Ç–∏ –∫–∏–ª–æ–º–µ—Ç—Ä–∏ (–≤–æ –∏–ª—ò–∞–¥–∏)", 
     ylab = "–ö—É–º—É–ª–∞—Ç–∏–≤–Ω–∞ —á–µ—Å—Ç–æ—Ç–∞", 
     main = "–ö—É–º—É–ª–∞—Ç–∏–≤–Ω–∞ —á–µ—Å—Ç–æ—Ç–∞ –Ω–∞ –ø–æ–º–∏–Ω–∞—Ç–∏ –∫–∏–ª–æ–º–µ—Ç—Ä–∏"
     ) 

plot(TABLE2$–ö—É–º—É–ª–∞—Ç–∏–≤–Ω–∏_—á–µ—Å—Ç–æ—Ç–∏2,
     type = "b", 
     col = "blue",
     xlab = "–¶–µ–Ω–∞ (–≤–æ –∏–ª—ò–∞–¥–∏)", 
     ylab = "–ö—É–º—É–ª–∞—Ç–∏–≤–Ω–∞ —á–µ—Å—Ç–æ—Ç–∞", 
     main = "–ö—É–º—É–ª–∞—Ç–∏–≤–Ω–∞ —á–µ—Å—Ç–æ—Ç–∞ –Ω–∞ —Ü–µ–Ω–∞"
     ) 


# –ó–ê–î–ê–ß–ê –ë–†. 2
#–ö–æ–Ω—Å—Ç—Ä—É–∏—Ä–∞—ö–µ –Ω–∞ —Å—Ç–µ–±–ª–æ - –ª–∏—Å—Ç –¥–∏—ò–∞–≥—Ä–∞–º

library(data.table)

#leftDigits - –ø–æ–∑–∏—Ü–∏—ò–∞ –Ω–∞ '|' –≤–æ –æ–¥–Ω–æ—Å –Ω–∞ –¥–µ—Ü–∏–º–∞–ª–Ω–∞—Ç–∞ —Ç–æ—á–∫–∞; rounding - –±—Ä. –Ω–∞ –¥–µ—Ü–∏–º–∞–ª–∏;
myStem <- function(x, leftDigits, rounding = 1){
  data = data.table("x" = x)
  data[, left := floor(x/10^leftDigits)]
  data[, right := (round(x - left*10^leftDigits, rounding))*10^rounding]
  data = data[, paste(sort(right), collapse = ""), by = left]
  data[, out := paste(left, " | ", V1), by = left]
  cat(data$out, sep = "\n")
}

myStem(sorted_Kilometers1, 1, 0)
myStem(sorted_Price1, 1, 0)


# –ó–ê–î–ê–ß–ê –ë–†. 3
#–ì—Ä–∞—Ñ–∏–∫–∞ –∑–∞ —Ä–∞—Å–µ—ò—É–≤–∞—ö–µ –Ω–∞ –ø–æ–¥–∞—Ç–æ—Ü–∏—Ç–µ

library(ggplot2)

plot(
  x=CARS$Kilometers1,
  y=CARS$Price1,
  xlab = "–ü–æ–º–∏–Ω–∞—Ç–∏ –∫–∏–ª–æ–º–µ—Ç—Ä–∏",
  ylab = "–¶–µ–Ω–∞",
  main = '–¶–µ–Ω–∞ –≤–æ –æ–¥–Ω–æ—Å –Ω–∞ –ø–æ–º–∏–Ω–∞—Ç–∏ –∫–∏–ª–æ–º–µ—Ç—Ä–∏',
  col = "salmon"
)


# –ó–ê–î–ê–ß–ê –ë–†. 4
#–û–ø—Ä–µ–¥–µ–ª—É–≤–∞—ö–µ –Ω–∞ –º–æ–¥–∞, –º–µ–¥–∏—ò–∞–Ω–∞ –∏ –ø—Ä–æ—Å–µ–∫

–ü–†–û–°–ï–ö1 = mean(CARS$Kilometers1)
–ü–†–û–°–ï–ö2 = mean(CARS$Price1)

–ú–ï–î–ò–à–ê–ù–ê1 = median(CARS$Kilometers1)
–ú–ï–î–ò–à–ê–ù–ê2 = median(CARS$Price1)

#–ö—Ä–µ–∏—Ä–∞—ö–µ —Ñ–æ—Ä–º—É–ª–∞ –∑–∞ –º–æ–¥–∞
getmode = function(x){
  uniqv = unique(x)
  uniqv[which.max(tabulate(match(x, uniqv)))]
}

–ú–û–î–ê1 = getmode(CARS$Kilometers1)
–ú–û–î–ê2 = getmode(CARS$Price1)


# –ó–ê–î–ê–ß–ê –ë–†. 5
#–û–ø—Ä–µ–¥–µ–ª—É–≤–∞—ö–µ –Ω–∞ –∫–≤–∞—Ä—Ç–∞–ª–∏, –æ–ø—Å–µ–≥ –∏ –∏–Ω—Ç–µ—Ä–∫–≤–∞—Ä—Ç–∞–ª–µ–Ω —Ä–∞—Å–ø–æ–Ω

Q1_–ö–∏–ª–æ–º–µ—Ç—Ä–∏ = quantile(CARS$Kilometers1, .25)
Q2_–ö–∏–ª–æ–º–µ—Ç—Ä–∏ = –ú–ï–î–ò–à–ê–ù–ê1
Q3_–ö–∏–ª–æ–º–µ—Ç—Ä–∏ = quantile(CARS$Kilometers1, .75)

Q1_–¶–µ–Ω–∞ = quantile(CARS$Price1, .25)
Q2_–¶–µ–Ω–∞ = –ú–ï–î–ò–à–ê–ù–ê2
Q3_–¶–µ–Ω–∞ = quantile(CARS$Price1, .75)

–û–ø—Å–µ–≥1 = R1[2] - R1[1]
–û–ø—Å–µ–≥2 = R2[2] - R2[1]

–ò–Ω—Ç–µ—Ä–∫–≤–∞—Ä—Ç–∞–ª–µ–Ω_—Ä–∞—Å–ø–æ–Ω1 = IQR(CARS$Kilometers1)
–ò–Ω—Ç–µ—Ä–∫–≤–∞—Ä—Ç–∞–ª–µ–Ω_—Ä–∞—Å–ø–æ–Ω2 = IQR(CARS$Price1)


# –ó–ê–î–ê–ß–ê –ë–†. 6
#–û–ø—Ä–µ–¥–µ–ª—É–≤–∞—ö–µ –Ω–∞ –¥–∏—Å–ø–µ—Ä–∑–∏—ò–∞ –∏ —Å—Ç–∞–Ω–¥–∞—Ä–¥–Ω–∞ –¥–µ–≤–∏—ò–∞—Ü–∏—ò–∞

–î–∏—Å–ø–µ—Ä–∑–∏—ò–∞1 = var(CARS$Kilometers1)
–î–∏—Å–ø–µ—Ä–∑–∏—ò–∞2 = var(CARS$Price1)

–°—Ç–∞–Ω–¥–∞—Ä–¥–Ω–∞_–¥–µ–≤–∏—ò–∞—Ü–∏—ò–∞1 = sd(CARS$Kilometers1)
–°—Ç–∞–Ω–¥–∞—Ä–¥–Ω–∞_–¥–µ–≤–∏—ò–∞—Ü–∏—ò–∞2 = sd(CARS$Price1)

# –ó–ê–î–ê–ß–ê –ë–†. 7
#–û–ø—Ä–µ–¥–µ–ª—É–≤–∞—ö–µ –Ω–∞ –∫–æ–µ—Ñ–∏—Ü–∏–µ–Ω—Ç –Ω–∞ –∫–æ—Ä–µ–ª–∞—Ü–∏—ò–∞

–ö–æ–µ—Ñ–∏—Ü–∏–µ–Ω—Ç_–Ω–∞_–∫–æ—Ä–µ–ª–∞—Ü–∏—ò–∞ = cor(CARS$Price1, CARS$Kilometers1)


# –ë. –í–¢–û–† –î–ï–õ 
# –ó–ê–î–ê–ß–ê –ë–†. 1

#–û–ø—Ä–µ–¥–µ–ª—É–≤–∞—ö–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª –Ω–∞ –¥–æ–≤–µ—Ä–±–∞ –∑–∞ –º–∞—Ç–µ–º–∞—Ç–∏—á–∫–æ –æ—á–µ–∫—É–≤–∞—ö–µ

library(distributions3)

–°—Ç–∞–Ω–¥–∞—Ä–¥–Ω–∞_–≥—Ä–µ—à–∫–∞ = –°—Ç–∞–Ω–¥–∞—Ä–¥–Ω–∞_–¥–µ–≤–∏—ò–∞—Ü–∏—ò–∞1/sqrt(n)
Z=Normal(0,1)
alpha = 0.05
z = quantile(Z, 1-alpha/2)
–î–æ–ª–Ω–∞_–≥—Ä–∞–Ω–∏—Ü–∞ = –ü–†–û–°–ï–ö1 - z * –°—Ç–∞–Ω–¥–∞—Ä–¥–Ω–∞_–≥—Ä–µ—à–∫–∞
–ì–æ—Ä–Ω–∞_–≥—Ä–∞–Ω–∏—Ü–∞ = –ü–†–û–°–ï–ö1 + z * –°—Ç–∞–Ω–¥–∞—Ä–¥–Ω–∞_–≥—Ä–µ—à–∫–∞

#–°–µ –¥–æ–±–∏–≤–∞ –¥–µ–∫–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ—Ç –Ω–∞ –¥–æ–≤–µ—Ä–±–∞ –∑–∞ –º–∞—Ç–µ–º–∞—Ç–∏—á–∫–æ—Ç–æ –æ—á–µ–∫—É–≤–∞—ö–µ –µ (58,02601; 60,99760)


# –ó–ê–î–ê–ß–ê –ë–†. 2
#–¢–µ—Å—Ç–∏—Ä–∞—ö–µ —Ö–∏–ø–æ—Ç–µ–∑–∏ –∑–∞ –º–∞—Ç–µ–º–∞—Ç–∏—á–∫–æ –æ—á–µ–∫—É–≤–∞—ö–µ
#–ù—É–ª—Ç–∞ —Ö–∏–ø–æ—Ç–µ–∑–∞: –ú–∞—Ç–µ–º–∞—Ç–∏—á–∫–æ—Ç–æ –æ—á–µ–∫—É–≤–∞—ö–µ –µ –µ–¥–Ω–∞–∫–≤–æ –Ω–∞ 62 (–∏–ª—ò–∞–¥–∏ –∫–∏–ª–æ–º–µ—Ç—Ä–∏)
#–ê–ª—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞ —Ö–∏–ø–æ—Ç–µ–∑–∞: –ú–∞—Ç–µ–º–∞—Ç–∏—á–∫–æ—Ç–æ –æ—á–µ–∫—É–≤–∞—ö–µ –Ω–µ –µ –µ–¥–Ω–∞–∫–≤–æ –Ω–∞ 62 (–∏–ª—ò–∞–¥–∏ –∫–∏–ª–æ–º–µ—Ç—Ä–∏)

library(BSDA)

z.test(x=CARS$Kilometers1, mu = 62, alternative = "two.sided", sigma.x = –°—Ç–∞–Ω–¥–∞—Ä–¥–Ω–∞_–¥–µ–≤–∏—ò–∞—Ü–∏—ò–∞1)
#–ü—Ä–µ–∫—É –æ–≤–æ—ò —Ç–µ—Å—Ç —Å–µ –¥–æ–±–∏–≤–∞, –¥–µ–∫–∞ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∞ –Ω–∞ p –µ –ø–æ–º–∞–ª–∞ –æ–¥ 0.05, –ø–æ—Ä–∞–¥–∏ —à—Ç–æ —ò–∞ –æ—Ç—Ñ—Ä–ª–∞–º–µ –Ω—É–ª—Ç–∞—Ç–∞ —Ö–∏–ø–æ—Ç–µ–∑–∞

#–ö—Ä–∏—Ç–∏—á–Ω–∏–æ—Ç –¥–æ–º–µ–Ω –µ ùê∂ = (‚àí‚àû; ‚àí1,95996) ‚à™ (1,95996; +‚àû)
#–í—Ä–µ–¥–Ω–æ—Å—Ç–∞ –Ω–∞ —Ç–µ—Å—Ç-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞—Ç–∞ –µ Z0 = ‚àí3.2823 –∏ –ø—Ä–∏–ø–∞—ì–∞ –Ω–∞ –∫—Ä–∏—Ç–∏—á–Ω–∏–æ—Ç –¥–æ–º–µ–Ω
#–ù—É–ª—Ç–∞—Ç–∞ —Ö–∏–ø–æ—Ç–µ–∑–∞ —Å–µ –æ—Ç—Ñ—Ä–ª–∞


# –ó–ê–î–ê–ß–ê –ë–†. 3
#–¢–µ—Å—Ç –∑–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–±–∞

shapiro.test(CARS$Kilometers1)
#–ù—É–ª—Ç–∞—Ç–∞ —Ö–∏–ø–æ—Ç–µ–∑–∞ –Ω–∞ Shapiro —Ç–µ—Å—Ç –µ –¥–µ–∫–∞ –ø–æ–¥–∞—Ç–æ—Ü–∏—Ç–µ –∏–º–∞–∞—Ç –Ω–æ—Ä–º–∞–ª–Ω–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–±–∞. 
#–°–æ–æ–¥–≤–µ—Ç–Ω–æ, –∞–ª—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—Ç–∞ —Ö–∏–ø–æ—Ç–µ–∑–∞ –µ –¥–µ–∫–∞ –ø–æ–¥–∞—Ç–æ—Ü–∏—Ç–µ –Ω–µ–º–∞–∞—Ç –Ω–æ—Ä–º–∞–ª–Ω–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–±–∞
#–í–æ –Ω–∞—à–∏–æ—Ç –ø—Ä–∏–º–µ—Ä, –±–∏–¥–µ—ò—ú–∏ p < 0.05, –Ω—É–ª—Ç–∞—Ç–∞ —Ö–∏–ø–æ—Ç–µ–∑–∞ —Å–µ –æ—Ç—Ñ—Ä–ª–∞ –∏ –∑–∞–∫–ª—É—á—É–≤–∞–º–µ –¥–µ–∫–∞ –ø–æ–¥–∞—Ç–æ—Ü–∏—Ç–µ –Ω–µ —Å–µ –Ω–æ—Ä–º–∞–ª–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏. 


# –ó–ê–î–ê–ß–ê –ë–†. 4
#–¢–µ—Å—Ç–∏—Ä–∞—ö–µ –Ω–∞ —Ö–∏–ø–æ—Ç–µ–∑–∏ –∑–∞ –Ω–µ–∑–∞–≤–∏—Å–Ω–æ—Å—Ç
#–ù—É–ª—Ç–∞ —Ö–∏–ø–æ—Ç–µ–∑–∞: –û–±–µ–ª–µ–∂—ò–∞—Ç–∞ —Å–æ–ø—Å—Ç–≤–µ–Ω–∏–∫ –∏ —Ç–∏–ø –Ω–∞ –≥–æ—Ä–∏–≤–æ —Å–µ –Ω–µ–∑–∞–≤–∏—Å–Ω–∏
#–ê–ª—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞ —Ö–∏–ø–æ—Ç–µ–∑–∞: –û–±–µ–ª–µ–∂—ò–∞—Ç–∞ —Å–æ–ø—Å—Ç–≤–µ–Ω–∏–∫ –∏ —Ç–∏–ø –Ω–∞ –≥–æ—Ä–∏–≤–æ –Ω–µ —Å–µ –Ω–µ–∑–∞–≤–∏—Å–Ω–∏

library(pivottabler)

NF1 = CARS[, c('Owner', 'Fuel.Type')]

pt2 = PivotTable$new()
pt2$addData(NF1)
pt2$addColumnDataGroups('Fuel.Type')
pt2$addRowDataGroups('Owner')
pt2$defineCalculation(calculationName = "TotalCount", summariseExpression = "n()")
pt2$evaluatePivot()

PT1 = pt2$asDataFrame()
PT1[is.na(PT1)]=0

chisq.test(PT1)

—Å—Ç–µ–ø–µ–Ω_–Ω–∞_—Å–ª–æ–±–æ–¥–∞ = (length(unique(CARS$Owner))-1) * (length(unique(CARS$Fuel.Type))-1)
qchisq(p=0.05, df=—Å—Ç–µ–ø–µ–Ω_–Ω–∞_—Å–ª–æ–±–æ–¥–∞, lower.tail=FALSE)

#–ü—Ä–µ–∫—É –æ–≤–æ—ò –ü–∏—Ä—Å–æ–Ω–æ–≤ (X–∏ –∫–≤–∞–¥—Ä–∞—Ç) —Ç–µ—Å—Ç, —Å–µ –¥–æ–±–∏–≤–∞ x2 = 19.492, –∞ –∫—Ä–∏—Ç–∏—á–Ω–∏–æ—Ç –¥–æ–º–µ–Ω –∑–∞–ø–æ—á–Ω—É–≤–∞ –æ–¥ 12.59159. 
#–°e –∑–∞–∫–ª—É—á—É–≤–∞ –¥–µ–∫–∞ –Ω—É–ª—Ç–∞—Ç–∞ —Ö–∏–ø–æ—Ç–µ–∑–∞ —Å–µ –æ—Ç—Ñ—Ä–ª–∞, —Ç.–µ. –æ–±–µ–ª–µ–∂—ò–∞—Ç–∞ —Å–æ–ø—Å—Ç–≤–µ–Ω–∏–∫ –∏ —Ç–∏–ø –Ω–∞ –≥–æ—Ä–∏–≤–æ –Ω–µ —Å–µ –Ω–µ–∑–∞–≤–∏—Å–Ω–∏. 


# –ó–ê–î–ê–ß–ê –ë–†. 5
#–†–µ–≥—Ä–µ—Å–∏–æ–Ω–∞ –∞–Ω–∞–ª–∏–∑–∞

#–°–ø–æ—Ä–µ–¥ –ø—Ä–µ—Ç—Ö–æ–¥–Ω–æ –Ω–∞–ø—Ä–∞–≤–µ–Ω–∏–æ—Ç –≥—Ä–∞—Ñ–∏–∫ –Ω–∞ —Ä–∞—Å–µ—ò—É–≤–∞—ö–µ, –ø—Ä–µ—Ç–ø–æ—Å—Ç–∞–≤—É–≤–∞–º–µ –¥–µ–∫–∞ –ø–æ–º–µ—ì—É –æ–±–µ–ª–µ–∂—ò–∞—Ç–∞ –∫–∏–ª–æ–º–µ—Ç—Ä–∏ –∏ —Ü–µ–Ω–∞ –Ω–µ –ø–æ—Å—Ç–æ–∏ –ø–æ–≤—Ä–∑–∞–Ω–æ—Å—Ç. 
#–ó–∞ –ø–æ–¥–¥—Ä–∂—É–≤–∞—ö–µ –Ω–∞ —Ç–∞–∞ –ø—Ä–µ—Ç–ø–æ—Å—Ç–∞–≤–∫–∞, –≥–æ –æ–¥—Ä–µ–¥—É–≤–∞–º–µ –∫–æ–µ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ—Ç –Ω–∞ –∫–æ—Ä–µ–ª–∞—Ü–∏—ò–∞

cor.test(CARS$Kilometers1,CARS$Price1)
#–ü–æ—Ä–∞–¥–∏ —Ç–æ–∞ —à—Ç–æ –≤—Ä–µ–¥–Ω–æ—Å—Ç–∞ –Ω–∞ –∫–æ–µ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ—Ç –Ω–∞ –∫–æ—Ä–µ–ª–∞—Ü–∏—ò–∞ –∑–∞ –æ–≤–æ—ò –ø—Ä–∏–º–µ—Ä–æ–∫ –µ -0.2326531, —Ç.–µ. –µ –ø–æ–±–ª–∏—Å–∫—É –¥–æ 0 –æ—Ç–∫–æ–ª–∫—É -1, —Å—Ç–∞–Ω—É–≤–∞ –∑–±–æ—Ä –∑–∞ –ø–æ—Å–ª–∞–±–∞ –Ω–µ–≥–∞—Ç–∏–≤–Ω–∞ –ª–∏–Ω–µ–∞—Ä–Ω–∞ –ø–æ–≤—Ä–∑–∞–Ω–æ—Å—Ç. 

#–û–¥—Ä–µ–¥—É–≤–∞—ö–µ –Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏—Ç–µ –Ω–∞ –º–æ–¥–µ–ª –Ω–∞ –ª–∏–Ω–µ–∞—Ä–Ω–∞ —Ä–µ–≥—Ä–µ—Å–∏—ò–∞
LR_model <- lm(CARS$Price1 ~ CARS$Kilometers1, data=CARS)
LR_model

#–°–æ –ø–æ–º–æ—à –Ω–∞ –æ–≤–∞–∞ —Ñ—É–Ω–∫—Ü–∏—ò–∞ —Å–µ –¥–æ–±–∏–≤–∞ –¥–µ–∫–∞:
# 1. –ø—Ä–µ—Å–µ–∫–æ—Ç —Å–æ y-–æ—Å–∫–∞—Ç–∞ (√ü0) –µ –µ–¥–Ω–∞–∫–æ–≤ –Ω–∞ 445.469
# 2. –∫–æ–µ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ—Ç –Ω–∞ –ø—Ä–∞–≤–µ—Ü (√ü1) –µ –µ–¥–Ω–∞–∫–æ–≤ –Ω–∞ -1.065
